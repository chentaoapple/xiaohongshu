#### http

**当建立协议的时候，tcp进行了3次握手：**

1、客户端发送了一个带有SYN的Tcp报文到服务器，这个三次握手中的开始。表示客户端想要和服务端建立连接。 主机A发送位码为syn＝1,随机产生seq number=1234567的数据包到服务器，主机B由SYN=1知道，A要求建立联机。

2、服务端接收到客户端的请求，返回客户端报文，这个报文带有SYN和ACK标志，询问客户端是否准备好。 主机B收到请求后要确认联机信息，向A发送ack number=(主机A的seq+1),syn=1,ack=1,随机产生seq=7654321的包。

3、客户端再次响应服务端一个ACK，表示我已经准备好。主机A收到后检查ack number是否正确，即第一次发送的seq number+1,以及位码ack是否为1，若正确，主机A会再发送ack number=(主机B的seq+1),ack=1，主机B收到后确认seq值与ack=1则连接建立成功。

**当终止协议的时候，tcp进行了4次握手：**

由于Tcp连接是进行全双工工作的，因此每个方向都必须单独进行关闭，这个原则是当一方完成他的数据发送的时候就发送一个FIN来终止这个方向的连接，收到这个FIN意味着这个方向上没有数据的流动，一个TCP连接在收到这个FIN之后还能发送消息，首先执行关闭的一方进行主动的关闭，而另一方进行被动的关闭。

1、TCP发送一个FIN，用来关闭客户到服务端的连接。 2、服务端收到这个FIN，他发回一个ACK，确认收到序号为收到序号+1，和SYN一样，一个FIN将占用一个序号。 3、服务端发送一个FIN到客户端，服务端关闭客户端的连接。 4、客户端发送ACK报文确认，并将确认的序号+1，这样关闭完成。



##### 优化

出发点：

1，努力消除或减少不必要的网络延迟。

2，将需要传输的数据压缩至最少。

